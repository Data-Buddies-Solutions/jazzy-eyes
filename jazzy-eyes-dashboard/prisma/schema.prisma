generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Brand {
  id                 Int       @id
  companyName        String    @map("company_name") @db.VarChar(255)
  companyId          Int       @map("company_id")
  brandName          String    @unique @map("brand_name") @db.VarChar(255)
  allocationQuantity Int       @map("allocation_quantity")
  discountPercentage Decimal   @map("discount_percentage") @db.Decimal(5, 2)
  createdAt          DateTime  @default(now()) @map("created_at")
  updatedAt          DateTime  @updatedAt @map("updated_at")
  products           Product[]

  @@map("brands")
}

model Product {
  compositeId  String                 @id @map("composite_id") @db.VarChar(255)
  brandId      Int                    @map("brand_id")
  styleNumber  String                 @map("style_number") @db.VarChar(100)
  colorCode    String                 @map("color_code") @db.VarChar(50)
  eyeSize      String                 @map("eye_size") @db.VarChar(20)
  gender       String                 @db.VarChar(20)
  frameType    String                 @map("frame_type") @db.VarChar(50)
  productType  String                 @map("product_type") @db.VarChar(20)
  createdAt    DateTime               @default(now()) @map("created_at")
  updatedAt    DateTime               @updatedAt @map("updated_at")
  transactions InventoryTransaction[]
  brand        Brand                  @relation(fields: [brandId], references: [id])

  @@index([brandId])
  @@index([styleNumber])
  @@map("products")
}

model InventoryTransaction {
  id              Int             @id @default(autoincrement())
  productId       String          @map("product_id") @db.VarChar(255)
  transactionType TransactionType @map("transaction_type")
  transactionDate DateTime        @map("transaction_date") @db.Date
  invoiceDate     DateTime?       @map("invoice_date") @db.Date
  invoiceNumber   String?         @map("invoice_number") @db.VarChar(100)
  quantity        Int
  unitCost        Decimal         @map("unit_cost") @db.Decimal(10, 2)
  unitPrice       Decimal         @map("unit_price") @db.Decimal(10, 2)
  status          String          @default("completed") @db.VarChar(50)
  notes           String?
  createdAt       DateTime        @default(now()) @map("created_at")
  updatedAt       DateTime        @updatedAt @map("updated_at")
  product         Product         @relation(fields: [productId], references: [compositeId])

  @@index([productId])
  @@index([transactionDate])
  @@index([transactionType])
  @@index([invoiceDate])
  @@map("inventory_transactions")
}

enum TransactionType {
  ORDER
  SALE
}
